"use strict";(self["webpackChunkhead_line"]=self["webpackChunkhead_line"]||[]).push([[268],{6059:function(t,n,e){e.r(n),e.d(n,{default:function(){return A}});var a=function(){var t=this,n=t._self._c;return n("div",[n("div",[n("van-nav-bar",{attrs:{fixed:"",title:"标题","left-text":"返回","left-arrow":""},scopedSlots:t._u([{key:"left",fn:function(){return[n("svg",{staticClass:"icon",attrs:{t:"1661941600982",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2086",width:"32",height:"32"}},[n("path",{attrs:{d:"M1023.6801 177.544517A185.222118 185.222118 0 0 0 839.097782 0H184.902218A184.902218 184.902218 0 0 0 0 \n                          184.902218v54.383005zM0 853.813183A184.582318 184.582318 0 0 0 184.902218 1023.6801h653.875664A184.902218 184.902218 \n                          0 0 0 1023.6801 839.097782v-47.345205zM566.862855 499.044049c-5.758201 2.5592-17.914402 0-23.352702 2.5592a69.098407 \n                          69.098407 0 0 0-16.954702 0 199.297719 199.297719 0 0 0 1.599501 52.143705l54.702905-2.5592a171.466417 171.466417 0 0 0 \n                          16.954702-8.957201c24.312402-10.556701 46.385505-22.393002 69.098406-33.909403a319.900031 319.900031 0 0 0 58.541706-28.791003 \n                          174.025617 174.025617 0 0 1 47.025305 16.954701c19.833802 7.677601 38.707904 11.196501 58.541705 19.513902a447.860044 447.860044 0 0 0 \n                          44.466105 18.234302l57.262105-3.8388v-1.5995a187.781318 187.781318 0 0 0 0-52.143705L895.720087 479.850047a469.613246 469.613246 0 0 \n                          1-45.745704-18.234302 206.65542 206.65542 0 0 1-46.705405-16.634802l127.960013-63.980006a479.850047 479.850047 0 0 0 0-91.491409c-63.980006 \n                          5.1184-124.761012 7.677601-191.940019 11.836301a270.635426 270.635426 0 0 1-71.657607 2.559201l-61.100906-30.070603c-17.274602 \n                          28.791003-37.108404 56.622306-54.702905 84.773508a178.824117 178.824117 0 0 1-26.231803 41.906904c2.8791 7.997501 12.796001 7.357701 \n                          20.793502 10.236801a212.733521 212.733521 0 0 1 43.186505 16.954702c8.957201-1.5995 10.236801-11.516401 14.395501-18.234302 \n                          10.556701-16.634802 23.352702-33.909403 33.909403-50.864105a349.010934 349.010934 0 0 0 71.657607-3.8388h25.911903c12.796001-1.9194 \n                          30.390503 0 43.186504-3.838801 22.712902-5.1184 50.864105 2.8791 71.657607-4.1587v1.5995a17.594502 17.594502 0 0 1 0 8.957201c-4.4786 \n                          8.637301-21.433302 11.196501-30.070603 15.675101l-62.380506 31.990004a112.284911 112.284911 0 0 0-24.952202 11.836301 223.930022 223.930022 \n                          0 0 1-57.262106-21.113402A118.043112 118.043112 0 0 1 639.800062 383.880037c-10.236801 2.5592-25.592002 37.108404-33.909403 45.745705 1.9194 \n                          8.317401 42.226804 20.153702 52.143705 23.352702v1.5995c-30.390503 14.395501-59.501406 31.990003-90.211809 44.466105zM457.457045 \n                          598.213058a81.894408 81.894408 0 0 0 22.393002-1.5995A199.617619 199.617619 0 0 0 479.850047 543.830053l-95.97001 5.118401V393.477038a311.90253 \n                          311.90253 0 0 0 0-71.657607l-35.189003 2.559201c-7.037801 0-17.274602-1.9194-22.073102 0a95.970009 95.970009 0 0 0-22.393002 0v156.431115a311.90253 \n                          311.90253 0 0 1 0 71.657607l-230.967823 13.115901v52.143705a531.673852 531.673852 0 0 0 91.491409-5.1184c14.395501-2.8791 31.990003 3.5189 \n                          42.866604-2.5592h26.231803a80.614808 80.614808 0 0 0-14.395502 18.234301c-10.236801 14.395501-21.753202 28.471103-31.990003 43.186505-6.398001 \n                          8.637301-17.274602 16.634802-21.113402 27.511402-12.796001 3.199-63.980006 0-72.937207 6.398001a69.098407 69.098407 0 0 0-16.954702 0v52.143705a359.247735 \n                          359.247735 0 0 0 70.378007-5.118401c8.957201-1.9194 21.753202 0 28.791003 0 13.435801-2.8791 37.428304 3.199 47.025305-2.5592s26.871603-31.990003 \n                          33.909403-43.186504c24.952202-34.549203 57.901906-68.458607 80.934708-104.28741a466.734146 466.734146 0 0 0 76.776007-5.118401c13.115901-3.199 37.108404 2.8791 46.705405-2.8791z",fill:"#d81e06","p-id":"2087"}}),n("path",{attrs:{d:"M167.947516 432.504842a35.189003 35.189003 0 0 0 20.793502 \n                          0l67.179007-2.5592c0-12.476101-12.156201-17.914402-18.234302-25.911903C223.930022 383.880037 206.01562 \n                          367.885036 194.179319 348.051234l-63.980006 3.8388h-24.952203c3.8388 10.556701 14.715401 17.594502 21.113402 \n                          25.911903a398.275539 398.275539 0 0 0 41.587004 53.423305zM170.826617 534.233052a80.614808 80.614808 0 0 0 25.911902 0L255.920025 \n                          530.074352c-2.2393-9.277101-10.876601-14.075601-15.675102-20.793502-10.236801-13.755701-20.153702-26.551703-30.070602-40.307404-4.7985-6.398001-12.796001-11.516401-15.675102-19.833802a199.297719 199.297719 \n                          0 0 0-54.702905 2.8791c-7.677601 0-18.234302-2.2393-23.672603 0a39.347704 39.347704 0 0 0-11.516401 0c12.476101 19.833802 31.990003 36.148704 44.146205 54.702905 5.758201 7.677601 11.516401 21.433302 21.113402 24.952203z",fill:"#d81e06","p-id":"2088"}}),n("path",{attrs:{d:"M934.747891 598.213058v-51.184005c-59.501406 0-106.84661 8.317401-164.108716 7.997501v-24.952202a257.839425 257.839425 0 0 0-50.864105 2.5592c-7.997501 1.9194-20.153702-2.2393-26.231802 0h-2.559201a86.373008 86.373008 \n                          0 0 1 0 26.231803l-162.829115 8.9572v52.143706a275.433927 275.433927 0 0 0 54.702905-3.838801c16.314902-3.5189 33.909403 0 48.304905-2.5592s38.068104 3.5189 47.985004-2.5592a50.544205 50.544205 0 0 1 13.115902 \n                          0v77.095907a150.353015 150.353015 0 0 0 0 36.468604c20.473602-1.9194 52.783505-3.8388 77.095907-5.118401V641.079663a134.677913 134.677913 0 0 1 4.158701-33.269604c54.383005 0 107.48641-5.758201 \n                          159.950015-8.957201zM427.706342 614.84786l-87.332709 4.1587a121.562012 121.562012 0 0 0 18.234302 37.748204c14.715401 28.791003 29.750703 56.622306 42.866604 86.053109l54.702906-2.559201a81.574508 81.574508 0 0 0 \n                          31.990003-2.5592c2.8791-7.677601-11.836301-25.272102-15.675102-31.990003-15.675102-30.390503-29.110903-61.420806-45.425804-90.211809z",fill:"#d81e06","p-id":"2089"}}),n("path",{attrs:{d:"M892.840987 614.84786h-5.1184c-3.8388 2.5592-13.435801 0-19.513902 1.5995a184.902218 184.902218 0 0 0-53.423305 5.118401 168.267416 168.267416 0 0 1 21.113402 35.189003c11.836301 19.513902 25.272102 38.388004 \n                          36.468603 58.861606a370.764136 370.764136 0 0 0 63.980006-4.158701h18.234302a1129.56701 1129.56701 0 0 0-58.541705-97.889409zM657.074664 627.963761c-4.7985 3.199-14.075601 0-20.793502 1.5995-15.355201 3.199-45.105904 \n                          0-55.022805 5.118401s-8.637301 16.314902-12.796001 23.352702c-9.597001 15.675102-18.874102 31.990003-27.511403 49.584505-4.4786 7.997501-6.398001 18.874102-13.115901 24.952203a17.914402 17.914402 0 0 1 0 \n                          3.8388l79.975007-3.8388c12.476101-24.312402 26.231803-49.264605 39.027804-73.257108a140.116214 140.116214 0 0 1 13.115901-25.911902c0-4.1587 0-3.199-2.5592-5.438301z",fill:"#d81e06","p-id":"2090"}})])]},proxy:!0},{key:"right",fn:function(){return[n("van-icon",{attrs:{name:"search",size:"18",color:"#fff"},on:{click:t.searchFn}})]},proxy:!0}])})],1),n("div",{staticClass:"tab_container"},[n("van-tabs",{attrs:{sticky:"",animated:"","offset-top":"1.226667rem"},on:{change:t.channelChangeFn},model:{value:t.channelActive,callback:function(n){t.channelActive=n},expression:"channelActive"}},t._l(t.userChannelList,(function(t){return n("van-tab",{key:t.id,attrs:{name:t.id,title:t.name}},[n("div",{staticClass:"t1"},[n("article-list",{attrs:{channelId:t.id}})],1)])})),1),n("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.3733334rem"},on:{click:t.plusClickFn}})],1),n("van-popup",{staticClass:"chnnel_popup",attrs:{"get-container":"body"},model:{value:t.show,callback:function(n){t.show=n},expression:"show"}},[n("channel-edit",{attrs:{userList:t.userChannelList,unCheckList:t.unCheckChannelList},on:{addChannelEV:t.addChannelFn,removeChannelEV:t.removeChannelFn,closeEV:t.closeFn},model:{value:t.channelActive,callback:function(n){t.channelActive=n},expression:"channelActive"}})],1)],1)},i=[],s=function(){var t=this,n=t._self._c;return n("div",[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(n){t.isLoading=n},expression:"isLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1,offset:"50"},on:{load:t.onLoad},model:{value:t.loading,callback:function(n){t.loading=n},expression:"loading"}},t._l(t.list,(function(e){return n("article-item",{key:e.art_id,attrs:{articleObj:e},on:{dislikeEV:t.dislikeFn,reports:t.reportFn},nativeOn:{click:function(n){return t.itemClickFn(e.art_id)}}})})),1)],1)],1)},l=[],c=(e(4920),e(8848)),r=e(3505),o=e(666),d=e(6199),h={data(){return{list:[],loading:!1,finished:!1,theTime:(new Date).getTime(),isLoading:!1}},components:{ArticleItem:o.Z},props:{channelId:{type:Number,default:()=>0}},created(){this.getArticleListFn()},methods:{async getArticleListFn(){const{data:t}=await(0,d.ii)({channelId:this.channelId,timestamp:this.theTime});if(this.theTime=t.data.pre_timestamp,this.list=[...this.list,...t.data.results],this.loading=!1,null===t.data.pre_timestamp)return this.finished=!0,0;this.isLoading=!1},async onLoad(){0!==this.list.length&&this.getArticleListFn()},async onRefresh(){this.list=[],this.theTime=(new Date).getTime(),this.getArticleListFn()},async dislikeFn(t){(0,r.LP)();try{await(0,d.sp)({artId:t}),(0,c.Z)("不感兴趣")}catch(n){(0,c.Z)("删除失败")}},async reportFn(t,n){try{await(0,d.sk)({artId:t,type:n}),(0,c.Z)("反馈成功")}catch(e){(0,c.Z)("反馈失败")}},itemClickFn(t){this.$router.push(`/detail?art_id=${t}`)}}},u=h,m=e(1001),v=(0,m.Z)(u,s,l,!1,null,"6e252318",null),f=v.exports,p=e(4946);const _=()=>(0,p.Z)({url:"/v1_0/channels",method:"GET"}),C=()=>(0,p.Z)({url:"/v1_0/user/channels",method:"GET"}),k=({channels:t})=>(0,p.Z)({url:"/v1_0/user/channels",method:"PUT",data:{channels:t}}),g=({channelId:t})=>(0,p.Z)({url:`/v1_0/user/channels/${t}`,method:"DELETE"});var E=function(){var t=this,n=t._self._c;return n("div",[n("van-nav-bar",{attrs:{title:"频道管理"},scopedSlots:t._u([{key:"right",fn:function(){return[n("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:t.closeFn}})]},proxy:!0}])}),n("div",{staticClass:"my-channel-box"},[n("div",{staticClass:"channel-title"},[n("span",[t._v("我的频道 "),n("span",{staticClass:"small-title"},[t._v(" 点击"+t._s(t.isEdit?"删除":"进入")+"频道 ")])]),n("span",{on:{click:t.editFn}},[t._v(t._s(t.isEdit?"完成":"编辑"))])]),n("van-row",{attrs:{type:"flex"}},t._l(t.userList,(function(e){return n("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(n){return t.mydelFn(e)}}},[n("div",{staticClass:"channel-item van-hairline--surround"},[t._v(" "+t._s(e.name)+" "),n("van-badge",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&0!==e.id,expression:"isEdit && item.id !== 0"}],staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:t._u([{key:"content",fn:function(){return[n("van-icon",{staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)})],1)])})),1)],1),n("div",{staticClass:"more-channel-box"},[t._m(0),n("van-row",{attrs:{type:"flex"}},t._l(t.unCheckList,(function(e){return n("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(n){return t.moreFn(e)}}},[n("div",{staticClass:"channel-item van-hairline--surround"},[t._v(t._s(e.name))])])})),1)],1)],1)},L=[function(){var t=this,n=t._self._c;return n("div",{staticClass:"channel-title"},[n("span",[t._v("点击添加更多频道：")])])}],y={name:"ChnnelEdit",props:{userList:Array,unCheckList:Array},data(){return{isEdit:!1}},methods:{editFn(){this.isEdit=!this.isEdit},moreFn(t){!0===this.isEdit&&this.$emit("addChannelEV",t)},mydelFn(t){!0===this.isEdit?0!==t.id&&this.$emit("removeChannelEV",t):(this.$emit("closeEV"),this.$emit("input",t.id))},closeFn(){this.$emit("closeEV",!1),this.isEdit=!1}}},w=y,F=(0,m.Z)(w,E,L,!1,null,"3dc08ee2",null),T=F.exports,x={name:"myHome",data(){return{channelActive:0,userChannelList:[],allChannelList:[],show:!1,channelScrollObj:{}}},components:{ArticleList:f,ChannelEdit:T},async created(){const{data:t}=await C();this.userChannelList=t.data.channels;const{data:n}=await _();this.allChannelList=n.data.channels},methods:{plusClickFn(){this.show=!0},async addChannelFn(t){this.userChannelList.push(t);const n=this.userChannelList.filter((t=>0!==t.id)),e=n.map(((t,n)=>{const e={...t};return e}));await k({channels:e})},async removeChannelFn(t){const n=this.userChannelList.findIndex((n=>n.id===t.id));this.userChannelList.splice(n,1),await g({channelId:t.id})},closeFn(){this.show=!1},searchFn(){this.$router.push("/search")},scrollFn(){this.$route.meta.myscrollT=document.documentElement.scrollTop,this.channelScrollObj[this.channelActive]=document.documentElement.scrollTop},channelChangeFn(){this.$nextTick((()=>{document.documentElement.scrollTop=this.channelScrollObj[this.channelActive]}))}},computed:{unCheckChannelList(){const t=this.allChannelList.filter((t=>{const n=this.userChannelList.findIndex((n=>n.id===t.id));return!(n>-1)}));return t}},activated(){window.addEventListener("scroll",this.scrollFn),document.documentElement.scrollTop=this.$route.meta.myscrollT},deactivated(){window.removeEventListener("scroll",this.scrollFn)}},Z=x,b=(0,m.Z)(Z,a,i,!1,null,"2e010f1a",null),A=b.exports},6199:function(t,n,e){e.d(n,{Q1:function(){return m},_3:function(){return h},dX:function(){return d},ge:function(){return f},ii:function(){return i},nW:function(){return u},nt:function(){return o},qK:function(){return c},sk:function(){return l},sp:function(){return s},th:function(){return v},ty:function(){return r}});var a=e(4946);const i=({channelId:t,timestamp:n})=>(0,a.Z)({url:"/v1_0/articles",method:"GET",params:{channel_id:t,timestamp:n}}),s=({artId:t})=>(0,a.Z)({url:"/v1_0/article/dislikes",method:"POST",data:{target:t}}),l=({artId:t,type:n})=>(0,a.Z)({url:"/v1_0/article/reports",method:"POST",data:{target:t,type:n,remark:"如果想写,在逻辑页面下如果点击的类型是0,给出弹窗输入,传参到这"}}),c=({artId:t})=>(0,a.Z)({url:`/v1_0/articles/${t}`,method:"GET"}),r=({uid:t})=>(0,a.Z)({url:"/v1_0/user/followings",method:"POST",data:{target:t}}),o=({uid:t})=>(0,a.Z)({url:`/v1_0/user/followings/${t}`,method:"DELETE"}),d=({artId:t})=>(0,a.Z)({url:"/v1_0/article/likings",method:"POST",data:{target:t}}),h=({artId:t})=>(0,a.Z)({url:`/v1_0/article/likings/${t}`,method:"DELETE"}),u=({id:t,offset:n=null,limit:e=10})=>(0,a.Z)({url:"/v1_0/comments",method:"GET",params:{type:"a",source:t,offset:n,limit:e}}),m=({comId:t})=>(0,a.Z)({url:"/v1_0/comment/likings",method:"POST",data:{target:t}}),v=({comId:t})=>(0,a.Z)({url:`/v1_0/comment/likings/${t}`,method:"DELETE"}),f=({id:t,content:n,artId:e=null})=>{const i={target:t,content:n};return null!==e&&(i.art_id=e),(0,a.Z)({url:"/v1_0/comments",method:"POST",data:i})}}}]);
//# sourceMappingURL=Home.0f2569c9.js.map