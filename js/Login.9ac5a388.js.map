{"version":3,"file":"js/Login.9ac5a388.js","mappings":"8JAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,cAAc,CAACE,MAAM,CAAC,MAAQ,WAAWF,EAAG,WAAW,CAACG,GAAG,CAAC,OAASL,EAAIM,WAAW,CAACJ,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,SAAS,MAAQ,MAAM,YAAc,MAAM,MAAQ,CAC9O,CACEG,UAAU,EACVC,QAAS,WACTC,QAAS,oBACTC,QAAS,cAEVC,MAAM,CAACC,MAAOZ,EAAIa,KAAKC,OAAQC,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIa,KAAM,SAAUG,EAAK,EAACE,WAAW,iBAAiBhB,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,WAAW,KAAO,OAAO,MAAQ,KAAK,YAAc,KAAK,MAAQ,CACvN,CACEG,UAAU,EACVC,QAAS,WACTC,QAAS,UACTC,QAAS,cAEVC,MAAM,CAACC,MAAOZ,EAAIa,KAAKM,KAAMJ,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIa,KAAM,OAAQG,EAAK,EAACE,WAAW,eAAehB,EAAG,MAAM,CAACkB,YAAY,CAAC,OAAS,SAAS,CAAClB,EAAG,aAAa,CAACE,MAAM,CAAC,MAAQ,GAAG,MAAQ,GAAG,QAAUJ,EAAIqB,OAAO,eAAe,OAAO,SAAWrB,EAAIqB,OAAO,KAAO,OAAO,cAAc,WAAW,CAACrB,EAAIsB,GAAG,UAAU,IAAI,IAAI,EACnV,EACGC,EAAkB,G,4DC4CtB,GACAC,KAAAA,YACAC,OACA,OACAZ,KAAAA,CACAC,OAAAA,cACAK,KAAAA,IAEAA,KAAAA,SAEAE,QAAAA,EAEA,EACAK,QAAAA,CAGA,kBAKA,eACA,IAEA,MAAAD,KAAAA,SAAA,SACAX,OAAAA,KAAAA,KAAAA,OACAK,KAAAA,KAAAA,QAGAQ,EAAAA,EAAAA,IAAAA,EAAAA,KAAAA,QACAC,EAAAA,EAAAA,IAAAA,gBAAAA,EAAAA,KAAAA,gBACA,QAAApB,QAAAA,SAKA,sBAAAqB,KAAAA,KAAAA,OAAAA,MAAAA,MAAAA,gBAIA,CAHA,UAEAC,EAAAA,EAAAA,GAAAA,CAAAC,KAAAA,SAAAvB,QAAAA,YACA,CAEA,cACA,ICvG8P,I,UCO1PwB,GAAY,OACd,EACAjC,EACAwB,GACA,EACA,KACA,WACA,MAIF,EAAeS,EAAiB,O,sKCbzB,MAAMC,EAAW,EAAGnB,SAAQK,WACxBe,EAAAA,EAAAA,GAAM,CACTC,IAAK,uBACLC,OAAQ,OACRX,KAAM,CACFX,SACAK,UAOCkB,EAAiB,KACnBH,EAAAA,EAAAA,GAAM,CACTC,IAAK,qBACLC,OAAQ,QAKHE,EAAc,KAChBJ,EAAAA,EAAAA,GAAM,CACTC,IAAK,aACLC,OAAQ,QAKHG,EAAsBC,IACxBN,EAAAA,EAAAA,GAAM,CACTC,IAAK,mBACLC,OAAQ,QAMRX,KAAMe,IAKDC,EAAuBC,IAChC,MAAMC,EAAM,CACRnB,KAAM,GACNoB,OAAQ,EACRC,SAAU,IAGd,IAAK,MAAMC,KAAOH,OAEOI,IAAjBL,EAAQI,UACDH,EAAIG,GAGXH,EAAIG,GAAOJ,EAAQI,GAG3B,OAAOZ,EAAAA,EAAAA,GAAM,CACTC,IAAK,qBACLC,OAAQ,QACRX,KAAMkB,GAHV,C","sources":["webpack://head-line/./src/views/Login/index.vue","webpack://head-line/src/views/Login/index.vue","webpack://head-line/./src/views/Login/index.vue?db08","webpack://head-line/./src/views/Login/index.vue?8e58","webpack://head-line/./src/api/User.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('van-nav-bar',{attrs:{\"title\":\"头条-登录\"}}),_c('van-form',{on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"label\":\"手机号\",\"placeholder\":\"手机号\",\"rules\":[\n        {\n          required: true,\n          message: '请填写正确手机号',\n          pattern: /^1[3456789]\\d{9}$/,\n          trigger: 'onChange'\n        }\n      ]},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"name\":\"code\",\"label\":\"密码\",\"placeholder\":\"密码\",\"rules\":[\n        {\n          required: true,\n          message: '请填写6位数密码',\n          pattern: /^\\d{6}$/,\n          trigger: 'onChange'\n        }\n      ]},model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}}),_c('div',{staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"loading\":_vm.isLoad,\"loading-text\":\"正在加载\",\"disabled\":_vm.isLoad,\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登录 \")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <van-nav-bar title=\"头条-登录\" />\n    <van-form @submit=\"onSubmit\">\n      <van-field\n        v-model=\"user.mobile\"\n        name=\"mobile\"\n        label=\"手机号\"\n        placeholder=\"手机号\"\n        :rules=\"[\n          {\n            required: true,\n            message: '请填写正确手机号',\n            pattern: /^1[3456789]\\d{9}$/,\n            trigger: 'onChange'\n          }\n        ]\"\n      />\n      <van-field\n        v-model=\"user.code\"\n        type=\"password\"\n        name=\"code\"\n        label=\"密码\"\n        placeholder=\"密码\"\n        :rules=\"[\n          {\n            required: true,\n            message: '请填写6位数密码',\n            pattern: /^\\d{6}$/,\n            trigger: 'onChange'\n          }\n        ]\"\n      />\n      <div style=\"margin: 16px\">\n        <!-- native-type原生 button 标签的 type 属性,里面的submit 用于提交整个表单 -->\n        <van-button\n          round\n          block\n          :loading=\"isLoad\"\n          loading-text=\"正在加载\"\n          :disabled=\"isLoad\"\n          type=\"info\"\n          native-type=\"submit\"\n          >登录\n        </van-button>\n      </div>\n    </van-form>\n  </div>\n</template>\n\n<script>\n// 引入接口函数\nimport { loginAPI } from '@/api/User.js'\nimport { Toast } from 'vant'\nimport Notify from '@/ui/Notify.js'\n\nimport { setStorage } from '@/utils/storage'\n\n// 引入token各函数\nimport { setToken } from '@/utils/token.js'\nexport default {\n  name: 'userLogin',\n  data() {\n    return {\n      user: {\n        mobile: '13765588516', // 手机号\n        code: '' // 密码246810\n      },\n      code: '246810',\n      //点击登录\n      isLoad: false\n    }\n  },\n  methods: {\n    // 点击登录\n    // 点击后给提示且禁用，防止用户疯狂点击\n    async onSubmit(val) {\n      // onsubmit的val是表单对象\n      // val本来就是对象所以接口里变量数据名匹配自然能传参\n      // 还有loginAPI({...this.user})loginAPI(this.user)loginAPI({mobile:this.user.mobile})\n      // 点了之后先禁用再请求\n      this.isLoad = true\n      try {\n        // const { data: res } = await loginAPI(val)\n        const { data: res } = await loginAPI({\n          mobile: this.user.mobile,\n          code: this.code\n        })\n        // console.log(res)\n        setToken(res.data.token)\n        setStorage('refresh_token', res.data.refresh_token)\n        Toast({ message: '登录成功' })\n        // setRefreshToken(res.data.refresh_token)\n        // push跳转后,压栈, 会产生历史记录可以返回,\n        // replace跳转后,替换 无法返回\n        // 先看看是否有进入未遂的路由(401错误返回登录页点击登录回到原来的界面),没有的话就回到首页\n        this.$router.replace({ path: this.$route.query.path || '/layout/home' })\n      } catch (err) {\n        // promise ajax错误抛出因为async不会捕捉错误信息\n        Notify({ type: 'danger', message: '手机号或密码错误' })\n      }\n      // 无论请求成功失败 状态恢复\n      this.isLoad = false\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3f63a9de&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f63a9de\",\n  null\n  \n)\n\nexport default component.exports","// 统一封装接口\nimport axios from '@/utils/request.js'\n//  需要header的请求在请求拦截器里已经统一装好了\n\n// 登录接口\nexport const loginAPI = ({ mobile, code }) => {\n    return axios({\n        url: '/v1_0/authorizations',\n        method: 'POST',\n        data: {\n            mobile,\n            code\n        }\n    })\n}\n\n\n// 个人中心-用户个人资料,只要token,没有粉丝数关注等信息,给 我的 编辑用户资料用的\nexport const userProfileAPI = () => {\n    return axios({\n        url: '/v1_0/user/profile',\n        method: 'GET',\n    })\n}\n\n// 个人中心-用户所有信息，给 我的 界面显示用的\nexport const userInfoAPI = () => {\n    return axios({\n        url: '/v1_0/user',\n        method: 'GET',\n    })\n}\n\n// 个人中心-更新头像FormData表单\nexport const updateUserPhotoAPI = (fd) => {\n    return axios({\n        url: '/v1_0/user/photo',\n        method: 'PATCH',\n        // 如果请求体直接是FormData表单对象,不用自己添加Content-Type\n        // axios发现数据请求体是表单对象,他不会转换成json字符串\n        // 也不会带Content-Type:application/json,而是交给浏览器，\n        // 浏览器发现请求体是FormData会自己携带COntentType\n        // 传FormData的话请求体不能写data:{},否则还是转成json\n        data: fd\n    })\n}\n\n// 个人中心-更新基本信息\nexport const updatUserProfileAPI = (userObj) => {\n    const obj = {\n        name: '',\n        gender: 0,\n        birthday: ''\n    }\n    // 循环obj\n    for (const key in obj) {\n        // 如果外界传来的对象userObj没有key属性，就把obj的key属性删了\n        if (userObj[key] === undefined) {\n            delete obj[key]\n        } else {\n            // 若obj,userObj都有key的话,就把userObj的key替换掉obj的key\n            obj[key] = userObj[key]\n        }\n    }\n    return axios({\n        url: '/v1_0/user/profile',\n        method: 'PATCH',\n        data: obj\n        // 因为data里的参数不能忽略，但是这几个参数是可选值，所以\n        // 前端传递对象里面有前端需要的值，data接收这个对象\n        // data: {\n        //     name,\n        //     // 性别\n        //     gender,\n        //     birthday,\n        //     // 个人介绍\n        //     intro\n        // }\n\n    })\n}"],"names":["render","_vm","this","_c","_self","attrs","on","onSubmit","required","message","pattern","trigger","model","value","user","mobile","callback","$$v","$set","expression","code","staticStyle","isLoad","_v","staticRenderFns","name","data","methods","setToken","setStorage","path","Notify","type","component","loginAPI","axios","url","method","userProfileAPI","userInfoAPI","updateUserPhotoAPI","fd","updatUserProfileAPI","userObj","obj","gender","birthday","key","undefined"],"sourceRoot":""}